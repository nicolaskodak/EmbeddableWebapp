WITH src AS (
  SELECT * FROM (VALUES
    ('5.低脂培根現烤土司-牛奶吐司','手作現烤土司'),
    ('5.低脂培根現烤土司-蕃茄吐司','手作現烤土司'),
    ('5.低脂培根現烤土司','手作現烤土司'),
    ('3.培根起司蛋乳酪磚壓吐司-牛奶吐司','磚壓吐司'),
    ('3.培根起司蛋乳酪磚壓吐司-蕃茄吐司','磚壓吐司'),
    ('1.小熊兒童歡樂','幸福盤餐'),
    ('9.黃金脆薯條','小點'),
    ('11.麥克雞塊 (數量x4)','小點'),
    ('1.蔬果沙拉','健康沙拉'),
    ('4.阿薩姆紅茶(S)','茶飲'),
    ('1.嚴選美式咖啡(冰)400cc','咖啡'),
    ('2.嚴選美式咖啡(熱)400cc','咖啡'),
    ('3.嚴選美式咖啡(冰)500cc','咖啡'),
    ('4.嚴選美式咖啡(熱)500cc','咖啡'),
    ('5.嚴選拿鐵咖啡(冰)400cc','咖啡'),
    ('6.嚴選拿鐵咖啡(熱)400cc','咖啡'),
    ('7.嚴選拿鐵咖啡(冰)500cc','咖啡'),
    ('8.嚴選拿鐵咖啡(熱)500cc','咖啡'),
    ('4.蘋果醋(S)','飲品'),
    ('1.蛋堡-好事堡','好事堡/紫米堡/ 樂活堡'),
    ('1.蛋堡-紫米堡','好事堡/紫米堡/ 樂活堡'),
    ('1.蛋堡-樂活堡','好事堡/紫米堡/ 樂活堡'),
    ('1.蛋堡','好事堡/紫米堡/ 樂活堡'),
    ('2,田園珍豬-好事堡','好事堡/紫米堡/ 樂活堡'),
    ('2,田園珍豬-紫米堡','好事堡/紫米堡/ 樂活堡'),
    ('2,田園珍豬- 樂活堡','好事堡/紫米堡/ 樂活堡'),
    ('2,田園珍豬','好事堡/紫米堡/ 樂活堡'),
    ('3.麥香雞-好事堡','好事堡/紫米堡/ 樂活堡'),
    ('3.麥香雞-紫米堡','好事堡/紫米堡/ 樂活堡'),
    ('3.麥香雞-樂活堡','好事堡/紫米堡/ 樂活堡'),
    ('3.麥香雞','好事堡/紫米堡/ 樂活堡'),
    ('4.陽光加州蔬果-好事堡','好事堡/紫米堡/ 樂活堡'),
    ('4.陽光加州蔬果-紫米堡','好事堡/紫米堡/ 樂活堡'),
    ('4.陽光加州蔬果-樂活堡','好事堡/紫米堡/ 樂活堡'),
    ('4.陽光加州蔬果','好事堡/紫米堡/ 樂活堡'),
    ('5.活力起司歐姆蛋-好事堡','好事堡/紫米堡/ 樂活堡'),
    ('5.活力起司歐姆蛋-紫米堡','好事堡/紫米堡/ 樂活堡'),
    ('5.活力起司歐姆蛋-樂活堡','好事堡/紫米堡/ 樂活堡'),
    ('5.活力起司歐姆蛋','好事堡/紫米堡/ 樂活堡'),
    ('6.黑胡椒豬排-好事堡','好事堡/紫米堡/ 樂活堡'),
    ('6.黑胡椒豬排-紫米堡','好事堡/紫米堡/ 樂活堡'),
    ('6.黑胡椒豬排-樂活堡','好事堡/紫米堡/ 樂活堡'),
    ('6.黑胡椒豬排','好事堡/紫米堡/ 樂活堡'),
    ('7.日式梅醬豬排-好事堡','好事堡/紫米堡/ 樂活堡'),
    ('7.日式梅醬豬排-紫米堡','好事堡/紫米堡/ 樂活堡'),
    ('7.日式梅醬豬排-樂活堡','好事堡/紫米堡/ 樂活堡'),
    ('7.日式梅醬豬排','好事堡/紫米堡/ 樂活堡'),
    ('8.黃金薯餅起司-好事堡','好事堡/紫米堡/ 樂活堡'),
    ('8.黃金薯餅起司-紫米堡','好事堡/紫米堡/ 樂活堡'),
    ('8.黃金薯餅起司-樂活堡','好事堡/紫米堡/ 樂活堡'),
    ('8.黃金薯餅起司','好事堡/紫米堡/ 樂活堡'),
    ('9.法式藍帶豬排-好事堡','好事堡/紫米堡/ 樂活堡'),
    ('9.法式藍帶豬排-紫米堡','好事堡/紫米堡/ 樂活堡'),
    ('9.法式藍帶豬排-樂活堡','好事堡/紫米堡/ 樂活堡'),
    ('9.法式藍帶豬排','好事堡/紫米堡/ 樂活堡'),
    ('10.海老佐龍蝦沙拉-好事堡','好事堡/紫米堡/ 樂活堡'),
    ('10.海老佐龍蝦沙拉-紫米堡','好事堡/紫米堡/ 樂活堡'),
    ('10.海老佐龍蝦沙拉-樂活堡','好事堡/紫米堡/ 樂活堡'),
    ('10.海老佐龍蝦沙拉','好事堡/紫米堡/ 樂活堡'),
    ('11.霸王鮮脆雞-好事堡','好事堡/紫米堡/ 樂活堡'),
    ('11.霸王鮮脆雞-紫米堡','好事堡/紫米堡/ 樂活堡'),
    -- 原始清單中有一筆 product_name 含換行且 category_name = #N/A，這裡直接略過避免 SQL 語法風險
    ('11.霸王鮮脆雞-樂活堡','好事堡/紫米堡/ 樂活堡'),
    ('11.霸王鮮脆雞','好事堡/紫米堡/ 樂活堡'),
    ('12.紐約起司牛-好事堡','好事堡/紫米堡/ 樂活堡'),
    ('12.紐約起司牛-紫米堡','好事堡/紫米堡/ 樂活堡'),
    ('12.紐約起司牛-樂活堡','好事堡/紫米堡/ 樂活堡'),
    ('12.紐約起司牛','好事堡/紫米堡/ 樂活堡'),
    ('3.美式經典綠卡豬排漢堡','好事堡'),
    ('1.美式經典綠卡牛肉漢堡','好事堡'),
    ('2.韓國泡菜卡拉雞漢堡','好事堡'),
    ('1.煎蛋現烤土司-牛奶吐司','手作現烤土司'),
    ('1.煎蛋現烤土司-蕃茄吐司','手作現烤土司'),
    ('1.煎蛋現烤土司','手作現烤土司'),
    ('2.火腿現烤土司-牛奶吐司','手作現烤土司'),
    ('2.火腿現烤土司-蕃茄吐司','手作現烤土司'),
    ('2.火腿現烤土司','手作現烤土司'),
    ('3.肉鬆現烤土司-牛奶吐司','手作現烤土司'),
    ('3.肉鬆現烤土司-蕃茄吐司','手作現烤土司'),
    ('3.肉鬆現烤土司','手作現烤土司'),
    ('4.陽光加州蔬果現烤土司-牛奶吐司','手作現烤土司'),
    ('4.陽光加州蔬果現烤土司-蕃茄吐司','手作現烤土司'),
    ('4.陽光加州蔬果現烤土司','手作現烤土司'),
    ('6.鮪魚玉米現烤土司-牛奶吐司','手作現烤土司'),
    ('6.鮪魚玉米現烤土司-蕃茄吐司','手作現烤土司'),
    ('6.鮪魚玉米現烤土司','手作現烤土司'),
    ('7.黑胡椒豬排現烤土司-牛奶吐司','手作現烤土司'),
    ('7.黑胡椒豬排現烤土司-蕃茄吐司','手作現烤土司'),
    ('7.黑胡椒豬排現烤土司','手作現烤土司'),
    ('8.雙囍總匯蛋現烤土司-牛奶吐司','手作現烤土司'),
    ('8.雙囍總匯蛋現烤土司-蕃茄吐司','手作現烤土司'),
    ('8.雙囍總匯蛋現烤土司','手作現烤土司'),
    ('9.法式藍帶豬排現烤土司-牛奶吐司','手作現烤土司'),
    ('9.法式藍帶豬排現烤土司-蕃茄吐司','手作現烤土司'),
    ('9.法式藍帶豬排現烤土司','手作現烤土司'),
    ('10.霸王鮮脆雞現烤土司-牛奶吐司','手作現烤土司'),
    ('10.霸王鮮脆雞現烤土司-蕃茄吐司','手作現烤土司'),
    ('10.霸王鮮脆雞現烤土司','手作現烤土司'),
    ('11.海老佐龍蝦沙拉現烤土司-牛奶吐司','手作現烤土司'),
    ('11.海老佐龍蝦沙拉現烤土司-蕃茄吐司','手作現烤土司'),
    ('11.海老佐龍蝦沙拉現烤土司','手作現烤土司'),
    ('12.紐約起司牛現烤土司-牛奶吐司','手作現烤土司'),
    ('12.紐約起司牛現烤土司-蕃茄吐司','手作現烤土司'),
    ('12.紐約起司牛現烤土司','手作現烤土司'),
    ('1.草莓果醬現烤土司-牛奶吐司','手作現烤土司'),
    ('1.草莓果醬現烤土司-蕃茄吐司','手作現烤土司'),
    ('1.草莓果醬現烤土司-蕃茄厚片','手作現烤土司'),
    ('1.草莓果醬現烤土司','手作現烤土司'),
    ('2.椰香奶酥現烤土司-牛奶吐司','手作現烤土司'),
    ('2.椰香奶酥現烤土司-蕃茄吐司','手作現烤土司'),
    ('2.椰香奶酥現烤土司-蕃茄厚片','手作現烤土司'),
    ('2.椰香奶酥現烤土司','手作現烤土司'),
    ('3.香濃花生現烤土司-牛奶吐司','手作現烤土司'),
    ('3.香濃花生現烤土司-蕃茄吐司','手作現烤土司'),
    ('3.香濃花生現烤土司-蕃茄厚片','手作現烤土司'),
    ('3.香濃花生現烤土司','手作現烤土司'),
    ('4.濃郁巧克力現烤土司-牛奶吐司','手作現烤土司'),
    ('4.濃郁巧克力現烤土司-蕃茄吐司','手作現烤土司'),
    ('4.濃郁巧克力現烤土司-蕃茄厚片','手作現烤土司'),
    ('4.濃郁巧克力現烤土司','手作現烤土司'),
    ('1.水水蔬果乳酪磚壓吐司-牛奶吐司','磚壓吐司'),
    ('1.水水蔬果乳酪磚壓吐司-蕃茄吐司','磚壓吐司'),
    ('1.水水蔬果乳酪磚壓吐司','磚壓吐司'),
    ('2.火腿起司乳酪磚壓吐司-牛奶吐司','磚壓吐司'),
    ('2.火腿起司乳酪磚壓吐司-蕃茄吐司','磚壓吐司'),
    ('2.火腿起司乳酪磚壓吐司','磚壓吐司'),
    ('3.培根起司蛋乳酪磚壓吐司','磚壓吐司'),
    ('4.火腿玉米蛋乳酪磚壓吐司-牛奶吐司','磚壓吐司'),
    ('4.火腿玉米蛋乳酪磚壓吐司-蕃茄吐司','磚壓吐司'),
    ('4.火腿玉米蛋乳酪磚壓吐司','磚壓吐司'),
    ('5.黑胡椒豬排乳酪磚壓吐司-牛奶吐司','磚壓吐司'),
    ('5.黑胡椒豬排乳酪磚壓吐司-蕃茄吐司','磚壓吐司'),
    ('5.黑胡椒豬排乳酪磚壓吐司','磚壓吐司'),
    ('6.日式梅醬豬排乳酪磚壓吐司-牛奶吐司','磚壓吐司'),
    ('6.日式梅醬豬排乳酪磚壓吐司-蕃茄吐司','磚壓吐司'),
    ('6.日式梅醬豬排乳酪磚壓吐司','磚壓吐司'),
    ('7.鮪魚玉米乳酪磚壓吐司-牛奶吐司','磚壓吐司'),
    ('7.鮪魚玉米乳酪磚壓吐司-蕃茄吐司','磚壓吐司'),
    ('7.鮪魚玉米乳酪磚壓吐司','磚壓吐司'),
    ('8.龍蝦起司沙拉磚壓吐司-牛奶吐司','磚壓吐司'),
    ('8.龍蝦起司沙拉磚壓吐司-蕃茄吐司','磚壓吐司'),
    ('8.龍蝦起司沙拉磚壓吐司','磚壓吐司'),
    ('1.草莓果醬磚壓吐司-牛奶吐司','磚壓吐司2'),
    ('1.草莓果醬磚壓吐司-蕃茄吐司','磚壓吐司2'),
    ('1.草莓果醬磚壓吐司','磚壓吐司2'),
    ('2.椰香奶酥磚壓吐司-牛奶吐司','磚壓吐司2'),
    ('2.椰香奶酥磚壓吐司-蕃茄吐司','磚壓吐司2'),
    ('2.椰香奶酥磚壓吐司','磚壓吐司2'),
    ('3.香濃花生磚壓吐司-牛奶吐司','磚壓吐司2'),
    ('3.香濃花生磚壓吐司-蕃茄吐司','磚壓吐司2'),
    ('3.香濃花生磚壓吐司','磚壓吐司2'),
    ('4.濃郁巧克力磚壓吐司-牛奶吐司','磚壓吐司2'),
    ('4.濃郁巧克力磚壓吐司-蕃茄吐司','磚壓吐司2'),
    ('4.濃郁巧克力磚壓吐司','磚壓吐司2'),
    ('1.原味蛋餅','活力蛋餅'),
    ('2.玉米蛋餅','活力蛋餅'),
    ('3.起司蛋餅','活力蛋餅'),
    ('4.肉鬆蛋餅','活力蛋餅'),
    ('5.蔬菜蛋餅','活力蛋餅'),
    ('6.火腿蛋餅','活力蛋餅'),
    ('7.鮪魚玉米蛋餅','活力蛋餅'),
    ('8.薯餅蛋餅','活力蛋餅'),
    ('9.培根蛋餅','活力蛋餅'),
    ('10.黑胡椒豬排蛋餅','活力蛋餅'),
    ('11.黃金燻雞起司蛋餅','活力蛋餅'),
    ('12.壽喜燒牛肉蛋餅','活力蛋餅'),
    ('13.韓國泡菜起司蛋餅','活力蛋餅'),
    ('1.海味花枝米堡','紅藜QQ米堡'),
    ('2.壽喜燒牛肉米堡','紅藜QQ米堡'),
    ('3.黃金燻雞起司米堡','紅藜QQ米堡'),
    ('4.海老佐龍蝦沙拉米堡','紅藜QQ米堡'),
    ('5.麥香雞米堡','紅藜QQ米堡'),
    ('6. 燒醬黑胡椒豬肉米堡','紅藜QQ米堡'),
    ('1.府城醬香豬排單響炒泡麵','炒泡麵/ 湯泡麵'),
    ('2.乳酪絲豬排單響炒泡麵','炒泡麵/ 湯泡麵'),
    ('3.椒麻豬排單響炒泡麵','炒泡麵/ 湯泡麵'),
    ('4.韓國辣味豬排單響炒泡麵','炒泡麵/ 湯泡麵'),
    ('1.府城醬香豬排雙響炒泡麵','炒泡麵/ 湯泡麵'),
    ('2.乳酪絲豬排雙響炒泡麵','炒泡麵/ 湯泡麵'),
    ('3.乳酪絲豬排雙響炒泡麵','炒泡麵/ 湯泡麵'),
    ('3.椒麻豬排雙響炒泡麵','炒泡麵/ 湯泡麵'),
    ('4.韓國辣味豬排雙響炒泡麵','炒泡麵/ 湯泡麵'),
    ('5.北海牛奶起司湯泡麵','炒泡麵/ 湯泡麵'),
    ('5.北海牛奶起司鍋燒泡麵','炒泡麵/ 湯泡麵'),
    ('6.御膳十三香鍋燒泡麵','炒泡麵/ 湯泡麵'),
    ('7.韓國泡菜豬排單響炒泡麵','炒泡麵/ 湯泡麵'),
    ('1.韓國泡菜部隊鍋','部隊鍋'),
    ('1.海味花枝帕瑪森堡','香頌堡&帕瑪森堡'),
    ('2.燻雞帕瑪森堡','香頌堡&帕瑪森堡'),
    ('3.日式梅醬豬排帕瑪森堡','香頌堡&帕瑪森堡'),
    ('4.黃金薯餅起司帕瑪森堡','香頌堡&帕瑪森堡'),
    ('5.海老佐龍蝦沙拉帕瑪森堡','香頌堡&帕瑪森堡'),
    ('6.麥香雞蔬果帕瑪森堡','香頌堡&帕瑪森堡'),
    ('7.歐姆蛋起司蔬果帕瑪森堡','香頌堡&帕瑪森堡'),
    ('1.海味花枝香頌堡','香頌堡&帕瑪森堡'),
    ('2.燻雞香頌堡','香頌堡&帕瑪森堡'),
    ('3.日式梅醬豬排香頌堡','香頌堡&帕瑪森堡'),
    ('4.黃金薯餅起司香頌堡','香頌堡&帕瑪森堡'),
    ('5.海老佐龍蝦沙拉香頌堡','香頌堡&帕瑪森堡'),
    ('6.麥香雞蔬果香頌堡','香頌堡&帕瑪森堡'),
    ('7.歐姆蛋起司蔬果香頌堡','香頌堡&帕瑪森堡'),
    ('1.黑胡椒蘑菇義大利麵','異國美食'),
    ('2.蕃茄義大利麵','異國美食'),
    ('3.經典原味鍋燒意麵','異國美食'),
    ('4.法式藍帶豬排丼飯','異國美食'),
    ('5.海老龍蝦丼飯','異國美食'),
    ('6.白醬培根義大利麵','異國美食'),
    ('7.台灣沙茶豬肉鍋燒意麵','異國美食'),
    ('8.經典十三香鍋燒意麵','異國美食'),
    ('9.青醬海味花枝義大利麵','異國美食'),
    ('2.豬排總匯吐司拼盤','幸福盤餐'),
    ('3.鮮蝦優格水果沙拉','幸福盤餐'),
    ('4樂活迪克蛋盤餐','幸福盤餐'),
    ('5.輕食舒肥香草嫩雞胸時尚餐','幸福盤餐'),
    ('6.港式西多士盤餐','幸福盤餐'),
    ('7.法式土司盤餐','幸福盤餐'),
    ('1.荷包蛋','小點'),
    ('2.熱狗','小點'),
    ('3.帶財黃金薯餅 (數量x1)','小點'),
    ('4.鬆餅','小點'),
    ('5.德式香腸','小點'),
    ('6.炸花枝排','小點'),
    ('7.松葉薯球','小點'),
    ('8.港港好蘿蔔糕','小點'),
    ('10.月型薯條','小點'),
    ('12.極濃芋頭糕','小點'),
    ('13.炸藍帶豬排','小點'),
    ('14.現炸卡拉雞','小點'),
    ('15.懷舊小點拚盤 (蘿蔔糕x1芋頭糕x1煎蛋x1)','小點'),
    ('16.韓國泡菜(小菜)','小點'),
    ('1.韓國泡菜(大罐)','零售系列'),
    ('2.韓國泡菜(小罐)','零售系列'),
    ('2.燻雞沙拉','健康沙拉'),
    ('3.巧達玉米濃湯(冬季限定)(小)','濃湯'),
    ('3.巧達玉米濃湯(冬季限定)(中)','濃湯'),
    ('1.春芽玉露青茶(S)','茶飲'),
    ('2.春芽玉露青茶(M)','茶飲'),
    ('3.春芽玉露青茶(L)','茶飲'),
    ('5.阿薩姆紅茶(M)','茶飲'),
    ('6.阿薩姆紅茶(L)','茶飲'),
    ('7.阿薩姆奶茶(S)','茶飲'),
    ('8.阿薩姆奶茶(M)','茶飲'),
    ('9.阿薩姆奶茶(L)','茶飲'),
    ('10.阿薩姆鮮奶茶(S)','茶飲'),
    ('11.阿薩姆鮮奶茶(M)','茶飲'),
    ('12.阿薩姆鮮奶茶(L)','茶飲'),
    ('13.豆漿紅茶(S)','茶飲'),
    ('14.豆漿紅茶(M)','茶飲'),
    ('15.豆漿紅茶(L)','茶飲'),
    ('1.韓式柚子紅茶(S)','茶飲'),
    ('2.韓式柚子紅茶(M)','茶飲'),
    ('3.韓式柚子紅茶(L)','茶飲'),
    ('9.榛果風味拿鐵(冰)400cc','咖啡'),
    ('10.榛果風味拿鐵(熱)400cc','咖啡'),
    ('9.榛果風味拿鐵(冰)500cc','咖啡'),
    ('10.榛果風味拿鐵(熱)500cc','咖啡'),
    ('1.柳橙汁(S)','飲品'),
    ('2.柳橙汁(M)','飲品'),
    ('3.柳橙汁(L)','飲品'),
    ('5.蘋果醋(M)','飲品'),
    ('6.蘋果醋(L)','飲品'),
    ('7.阿華田(S)','飲品'),
    ('8.阿華田(M)','飲品'),
    ('9.阿華田(L)','飲品'),
    ('10水蜜桃可爾必思(S)','飲品'),
    ('11.水蜜桃可爾必思(M)','飲品'),
    ('12.水蜜桃可爾必思(L)','飲品'),
    ('13.非基因改造豆漿(S)','飲品'),
    ('14.非基因改造豆漿(M)','飲品'),
    ('15.非基因改造豆漿(L)','飲品'),
    ('16.白玉珍珠薏仁漿(S)','飲品'),
    ('17..白玉珍珠薏仁漿(M)','飲品'),
    ('18.白玉珍珠薏仁漿(L)','飲品'),
    ('草莓牛奶','飲品'),
    ('加購蛋','選項'),
    ('加購豬排','選項'),
    ('加購麵','選項'),
    ('加購起司','選項'),
    ('加購乳酪絲','選項'),
    ('1. 陽光蔬果-三明治','三明治系列'),
    ('2.凱薩鮮脆雞腿-三明治','三明治系列'),
    ('3.起司三明治-三明治','三明治系列'),
    ('4.火腿起司-三明治','三明治系列'),
    ('5.黑胡椒豬排-三明治','三明治系列'),
    ('6.麥香雞-三明治','三明治系列'),
    ('7.鮪魚玉米-三明治','三明治系列'),
    ('8.肉鬆-三明治','三明治系列'),
    ('1.麥香雞好事堡  ','速點套餐'),
    ('2.黑胡椒豬排好事堡  ','速點套餐'),
    ('3.府城醬香豬排炒泡麵(蛋)  ','速點套餐'),
    ('4.經典原味鍋燒意麵  ','速點套餐'),
    ('5.霸王鮮脆雞好事堡','速點套餐'),
    ('6.豬排蕃茄義大利麵  ','速點套餐'),
    ('7.白醬培根義大利麵','速點套餐'),
    ('8.鮪魚玉米現烤土司','速點套餐'),
    ('測試產品','健康沙拉'),
    ('◎黃金脆薯條','小點'),
    ('紫米漿','飲品')
  ) AS t(product_name, category_name)
),
norm AS (
  SELECT
    NULLIF(btrim(product_name), '') AS product_name,
    NULLIF(btrim(category_name), '') AS category_name
  FROM src
  WHERE NULLIF(btrim(product_name), '') IS NOT NULL
    AND NULLIF(btrim(category_name), '') IS NOT NULL
    AND btrim(category_name) <> '#N/A'
),
resolved AS (
  SELECT
    n.product_name,
    pc.category_id
  FROM norm n
  JOIN tb_mgmt.product_categories pc
    ON pc.category_name = n.category_name
)
INSERT INTO tb_mgmt.products (product_name, category_id)
SELECT r.product_name, r.category_id
FROM resolved r
ON CONFLICT (product_name) DO UPDATE
SET category_id = EXCLUDED.category_id;