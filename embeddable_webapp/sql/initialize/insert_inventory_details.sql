-- Generated from: embeddable_webapp/sql/reference/門市資料-store-details - inventory_details.csv
-- Rows: 150
--
-- inventory_details.erp_inventory_id 會透過 FK 參照 tb_mgmt.erp_inventory(id)
-- 本匯入會先 JOIN erp_inventory（用 product_code 對 CSV 的 product_code），避免插入找不到對應品項。

WITH raw(
  category,
  rank,
  item_code,
  shelf_life_days,
  shelf_life_category,
  sales_grade,
  lead_time_days,
  delivery,
  max_purchase_param,
  safety_stock_param,
  inventory_turnover_days
) AS (
VALUES
  (E'長效*熱銷', 1, E'A00002', 365, E'長效', E'熱銷', 7, E'W2、5；W5會較多', 7, 10, 17.5),
  (E'長效*熱銷', 2, E'C00245', 180, E'長效', E'熱銷', 60, NULL, 7, 10, 17.5),
  (E'長效*熱銷', 3, E'A00023', 180, E'長效', E'熱銷', 14, E'W1-5', 7, 10, 17.5),
  (E'長效*熱銷', 4, E'A00068', 540, E'長效', E'熱銷', 7, E'中午前訂.隔天到', 7, 10, 17.5),
  (E'長效*熱銷', 5, E'C00004', 365, E'長效', E'熱銷', 45, NULL, 7, 10, 17.5),
  (E'長效*熱銷', 6, E'A00029', 365, E'長效', E'熱銷', 30, E'W1', 7, 10, 17.5),
  (E'中效*熱銷', 7, E'A00235', 90, E'中效', E'熱銷', 7, NULL, 7, 10, 17.5),
  (E'長效*熱銷', 8, E'A00258', 180, E'長效', E'熱銷', 7, NULL, 7, 10, 17.5),
  (E'長效*熱銷', 9, E'A00016', 180, E'長效', E'熱銷', 7, E'W2、5 (1趟最少加總要10箱)', 7, 10, 17.5),
  (E'長效*熱銷', 10, E'A00078', 180, E'長效', E'熱銷', 7, E'W4', 7, 10, 17.5),
  (E'長效*中銷', 11, E'A00012', 365, E'長效', E'中銷', 7, E'W2、5 (1趟最少加總要10箱)', 7, 10, 17.5),
  (E'長效*中銷', 12, E'A00039', 180, E'長效', E'中銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*中銷', 13, E'C00164', 730, E'長效', E'中銷', 21, NULL, 7, 10, 17.5),
  (E'中效*中銷', 14, E'B00003', 30, E'中效', E'中銷', 7, E'W1、4', 7, 10, 17.5),
  (E'長效*中銷', 15, E'A00007', 180, E'長效', E'中銷', 7, E'W5 (W3可小量追加)', 7, 10, 17.5),
  (E'長效*中銷', 16, E'A00005', 365, E'長效', E'中銷', 14, E'W5', 7, 10, 17.5),
  (E'長效*中銷', 17, E'DTO003', 365, E'長效', E'中銷', 45, NULL, 7, 10, 17.5),
  (E'長效*中銷', 18, E'A00027', 180, E'長效', E'中銷', 7, E'W1-5', 7, 10, 17.5),
  (E'短效*中銷', 19, E'B00043', 14, E'短效', E'中銷', 1, NULL, 7, 10, 17.5),
  (E'長效*中銷', 20, E'DTO004', 365, E'長效', E'中銷', 45, NULL, 7, 10, 17.5),
  (E'長效*中銷', 21, E'A00164', 365, E'長效', E'中銷', 14, E'W2、4', 7, 10, 17.5),
  (E'中效*中銷', 22, E'A00175', 90, E'中效', E'中銷', 7, E'W3、5', 7, 10, 17.5),
  (E'長效*中銷', 23, E'A00006', 365, E'長效', E'中銷', 30, E'W5', 7, 10, 17.5),
  (E'長效*中銷', 24, E'A00192', 300, E'長效', E'中銷', 7, NULL, 7, 10, 17.5),
  (E'長效*中銷', 25, E'DTO010', 365, E'長效', E'中銷', 45, NULL, 7, 10, 17.5),
  (E'長效*中銷', 26, E'A00003', 180, E'長效', E'中銷', 7, E'W5\n(W3可小量追加)', 7, 10, 17.5),
  (E'長效*中銷', 27, E'A00052', 360, E'長效', E'中銷', 14, E'W2、4', 7, 10, 17.5),
  (E'長效*中銷', 28, E'C00179', 730, E'長效', E'中銷', 14, NULL, 7, 10, 17.5),
  (E'中效*中銷', 29, E'C00028', 30, E'中效', E'中銷', 7, E'固定W3', 7, 10, 17.5),
  (E'中效*中銷', 30, E'A00125', 90, E'中效', E'中銷', 30, E'W1、4', 7, 10, 17.5),
  (E'長效*慢銷', 31, E'A00001', 180, E'長效', E'慢銷', 7, E'W2、5\nW5會較多', 7, 10, 17.5),
  (E'中效*慢銷', 32, E'A00110', 90, E'中效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 33, E'A00185', 365, E'長效', E'慢銷', 30, E'通常同時間下單，可以不同時間配送。', 7, 10, 17.5),
  (E'長效*慢銷', 34, E'C00248', 365, E'長效', E'慢銷', 45, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 35, E'A00251', 730, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 36, E'A00041', 180, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 37, E'A00184', 365, E'長效', E'慢銷', 30, E'通常同時間下單，可以不同時間配送。', 7, 10, 17.5),
  (E'長效*慢銷', 38, E'A00053', 360, E'長效', E'慢銷', 14, E'W2、4', 7, 10, 17.5),
  (E'長效*慢銷', 39, E'B00026', 180, E'長效', E'慢銷', 14, E'W2、5', 7, 10, 17.5),
  (E'長效*慢銷', 40, E'A00013', 365, E'長效', E'慢銷', 7, E'W2、5\n(1趟最少加總要10箱)', 7, 10, 17.5),
  (E'長效*慢銷', 41, E'DTO008', 365, E'長效', E'慢銷', 21, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 42, E'DTO007', 365, E'長效', E'慢銷', 21, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 43, E'A00176', 365, E'長效', E'慢銷', 7, E'W2、5\n(1趟最少加總要10箱)', 7, 10, 17.5),
  (E'長效*慢銷', 44, E'C00224', 1095, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'中效*慢銷', 45, E'B00044', 90, E'中效', E'慢銷', 4, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 46, E'C00039', 1095, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 47, E'C00152', 365, E'長效', E'慢銷', 14, E'W2叫、W5送', 7, 10, 17.5),
  (E'長效*慢銷', 48, E'A00042', 120, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 49, E'DTO074', 365, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 50, E'A00028', 365, E'長效', E'慢銷', 30, E'W1', 7, 10, 17.5),
  (E'長效*慢銷', 51, E'DTO009', 365, E'長效', E'慢銷', 30, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 52, E'DTO051', 365, E'長效', E'慢銷', 45, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 53, E'A00248', 270, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 54, E'A00264', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 55, E'A00245', 365, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 56, E'C00251', 730, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 57, E'A00222', 730, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 58, E'B00041', 730, E'長效', E'慢銷', 7, E'W2-5', 7, 10, 17.5),
  (E'長效*慢銷', 59, E'C00011', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 60, E'C00001', 180, E'長效', E'慢銷', 14, E'W1', 7, 10, 17.5),
  (E'長效*慢銷', 61, E'C00012', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 62, E'C00032', 180, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 63, E'DTO014', 365, E'長效', E'慢銷', 30, NULL, 7, 10, 17.5),
  (E'中效*慢銷', 64, E'A00178', 90, E'中效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 65, E'A00161', 360, E'長效', E'慢銷', 14, E'W3', 7, 10, 17.5),
  (E'長效*慢銷', 66, E'A00004', 180, E'長效', E'慢銷', 7, E'W5\n(W3可小量追加)\n', 7, 10, 17.5),
  (E'長效*慢銷', 67, E'C00194', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 68, E'B00035', 180, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 69, E'A00147', 180, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 70, E'DTO062', 365, E'長效', E'慢銷', 30, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 71, E'DTO061', 365, E'長效', E'慢銷', 30, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 72, E'A00229', 180, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 73, E'C00247', 180, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'中效*慢銷', 74, E'A00129', 90, E'中效', E'慢銷', 30, E'不進', 7, 10, 17.5),
  (E'中效*慢銷', 75, E'A00111', 90, E'中效', E'慢銷', 7, E'W2、5\n(W2的車比較大台)', 7, 10, 17.5),
  (E'長效*慢銷', 76, E'A00143', 365, E'長效', E'慢銷', 45, E'W5', 7, 10, 17.5),
  (E'長效*慢銷', 77, E'A00260', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 78, E'C00151', 1095, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 79, E'A00249', 365, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 80, E'B00006', 120, E'長效', E'慢銷', 45, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 81, E'A00259', 730, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 82, E'DTO013', 365, E'長效', E'慢銷', 30, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 83, E'B00016', 180, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'短效*慢銷', 84, E'C00037', 0, E'短效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 85, E'C00142', 730, E'長效', E'慢銷', 45, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 86, E'C00033', 180, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 87, E'C00227', 540, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 88, E'DTO020', 365, E'長效', E'慢銷', 30, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 89, E'C00244', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 90, E'A00104', 365, E'長效', E'慢銷', 30, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 91, E'C00029', 180, E'長效', E'慢銷', 45, E'W4、5', 7, 10, 17.5),
  (E'長效*慢銷', 92, E'A00166', 365, E'長效', E'慢銷', 60, E'W5', 7, 10, 17.5),
  (E'長效*慢銷', 93, E'C00031', 365, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 94, E'B00039', 180, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 95, E'C00233', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 96, E'C00030', 180, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 97, E'C00013', 540, E'長效', E'慢銷', 7, E'W2', 7, 10, 17.5),
  (E'長效*慢銷', 98, E'C00187', 365, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 99, E'A00040', 180, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 100, E'DTO005', 365, E'長效', E'慢銷', 45, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 101, E'A00177', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 102, E'A00261', 730, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 103, E'A00223', 365, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 104, E'D00068', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 105, E'B00045', 180, E'長效', E'慢銷', 4, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 106, E'D00104', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 107, E'C00175', 270, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 108, E'D00105', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 109, E'C00038', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 110, E'D00102', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 111, E'A00131', 730, E'長效', E'慢銷', 4, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 112, E'C00043', 365, E'長效', E'慢銷', 3, E'W1-5', 7, 10, 17.5),
  (E'長效*慢銷', 113, E'C00184', 365, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 114, E'A00105', 365, E'長效', E'慢銷', 30, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 115, E'C00218', 1080, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 116, E'C00042', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 117, E'DTO075', 365, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 118, E'C00143', 730, E'長效', E'慢銷', 45, E'要下架了', 7, 10, 17.5),
  (E'長效*慢銷', 119, E'D00103', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 120, E'C00232', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 121, E'A00265', 730, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 122, E'C00186', 365, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 123, E'D00099', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 124, E'C00183', 730, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 125, E'C00040', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 126, E'C00185', 365, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 127, E'C00188', 365, E'長效', E'慢銷', NULL, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 128, E'D00098', 365, E'長效', E'慢銷', 7, E'W2', 7, 10, 17.5),
  (E'長效*慢銷', 129, E'C00010', 365, E'長效', E'慢銷', 7, E'W2', 7, 10, 17.5),
  (E'長效*慢銷', 130, E'D00108', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 131, E'C00240', 730, E'長效', E'慢銷', 7, E'W2', 7, 10, 17.5),
  (E'長效*慢銷', 132, E'D00067', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 133, E'D00060', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 134, E'D00087', 365, E'長效', E'慢銷', 30, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 135, E'D00069', 365, E'長效', E'慢銷', 30, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 136, E'C00041', 365, E'長效', E'慢銷', 7, E'W2', 7, 10, 17.5),
  (E'長效*慢銷', 137, E'D00011', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 138, E'D00009', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 139, E'D00015', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 140, E'D00106', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 141, E'D00061', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 142, E'D00045', 365, E'長效', E'慢銷', 14, E'W2', 7, 10, 17.5),
  (E'長效*慢銷', 143, E'D00002', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 144, E'D00065', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 145, E'D00005', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 146, E'DTO001', 365, E'長效', E'慢銷', 45, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 147, E'D00107', 365, E'長效', E'慢銷', 14, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 148, E'C00249', 365, E'長效', E'慢銷', 2, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 149, E'D00003', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5),
  (E'長效*慢銷', 150, E'D00018', 365, E'長效', E'慢銷', 7, NULL, 7, 10, 17.5)
)
INSERT INTO tb_mgmt.inventory_details (
  erp_inventory_id,
  category,
  rank,
  shelf_life_days,
  shelf_life_category,
  sales_grade,
  lead_time_days,
  delivery,
  max_purchase_param,
  safety_stock_param,
  inventory_turnover_days
)
SELECT
  e.id AS erp_inventory_id,
  r.category,
  r.rank,
  r.shelf_life_days,
  r.shelf_life_category,
  r.sales_grade,
  r.lead_time_days,
  r.delivery,
  r.max_purchase_param,
  r.safety_stock_param,
  r.inventory_turnover_days
FROM raw r
JOIN tb_mgmt.erp_inventory e
  ON e.product_code = r.item_code
ON CONFLICT (erp_inventory_id) DO UPDATE SET
  category = EXCLUDED.category,
  rank = EXCLUDED.rank,
  shelf_life_days = EXCLUDED.shelf_life_days,
  shelf_life_category = EXCLUDED.shelf_life_category,
  sales_grade = EXCLUDED.sales_grade,
  lead_time_days = EXCLUDED.lead_time_days,
  delivery = EXCLUDED.delivery,
  max_purchase_param = EXCLUDED.max_purchase_param,
  safety_stock_param = EXCLUDED.safety_stock_param,
  inventory_turnover_days = EXCLUDED.inventory_turnover_days,
  updated_at = NOW();

-- 先檢查有哪些 item_code 在 erp_inventory 不存在：
-- WITH raw(item_code) AS (VALUES
--   ...
-- )
-- SELECT r.item_code FROM raw r
-- LEFT JOIN tb_mgmt.erp_inventory e ON e.product_code = r.item_code
-- WHERE e.product_code IS NULL;
