-- Insert into tb_mgmt.erp_inventory_suppliers
-- Assumption: CSV column supplier_product_name matches tb_mgmt.erp_inventory.erp_inventory_name
-- You can run the two validation queries at the bottom to find any unmatched names before inserting.

WITH src(supplier_product_name, supplier_name) AS (
  VALUES
  ('◎熱狗','總倉'),
  ('◎低脂培根','總倉'),
  ('◎雞塊','總倉'),
  ('◎美式薯條','總倉'),
  ('◎蕃茄吐司-F','總倉'),
  ('◎美式鬆餅-HT','總倉'),
  ('◎牛奶土司','總倉'),
  ('●蕃茄村起士片(84片)','總倉'),
  ('●超拉絲乳酪絲','總倉'),
  ('●荷蘭醬','總倉'),
  ('●櫻島家100%鮮奶','總倉'),
  ('IN沙拉醬','總倉'),
  ('※雞塊沾醬','總倉'),
  ('蕃茄醬','總倉'),
  ('玉米粒','總倉'),
  ('巧克力醬','總倉'),
  ('蘋果醋','總倉'),
  ('皇家特選咖啡豆','總倉'),
  ('琥珀糖漿(箱)','總倉'),
  ('蕃茄醬包10g(袋)','總倉'),
  ('水果叉','總倉'),
  ('套餐用餐叉','總倉'),
  ('隔熱杯套(25個)','總倉'),
  ('咖啡耐熱杯蓋','總倉'),
  ('25cm斜口吸管','總倉'),
  ('2oz醬料杯','總倉'),
  ('中冰杯(蕃)','總倉'),
  ('400咖啡杯(蕃)','總倉'),
  ('土司盒(蕃)','總倉'),
  ('L型漢堡袋(蕃)','總倉'),
  ('套袋吸管(蕃)','總倉'),
  ('封口膜(蕃)','總倉'),
  ('蕃茄村蛋餅袋','總倉'),
  ('500咖啡杯(蕃)','總倉'),
  ('福曼沙香韻紅茶','總倉'),
  ('◎漢堡肉','總倉'),
  ('◎豬排肉','總倉'),
  ('◎大火腿','總倉'),
  ('◎小火腿','總倉'),
  ('◎特調德式香腸','總倉'),
  ('◎燻雞肉片','總倉'),
  ('◎卡啦雞腿','總倉'),
  ('◎手工蛋餅皮','總倉'),
  ('◎冷凍蘿蔔糕','總倉'),
  ('◎黑胡椒鐵板麵','總倉'),
  ('◎蕃茄雞肉麵','總倉'),
  ('◎好吃堡','總倉'),
  ('◎美式貝果','總倉'),
  ('◎樂活堡','總倉'),
  ('◎潛艇堡','總倉'),
  ('◎豆漿(HB)','總倉'),
  ('◎特選薏仁漿','總倉'),
  ('◎牛肉堡(10片)','總倉'),
  ('◎蕃茄湯底(1KG)-MS','總倉'),
  ('◎牛奶湯底-MS','總倉'),
  ('◎咕穀堡-F','總倉'),
  ('◎紫米堡','總倉'),
  ('◎冷凍青花菜-S','總倉'),
  ('◎雞高湯','總倉'),
  ('◎丹麥吐司','總倉'),
  ('◎義大利麵','總倉'),
  ('◎無糖豆漿','總倉'),
  ('◎蘑菇炒料','總倉'),
  ('◎麥香雞肉堡(通)','總倉'),
  ('◎蕃茄烏龍麵','總倉'),
  ('◎蕃茄厚片吐司','總倉'),
  ('◎藜麥米板','總倉'),
  ('◎日式牛丼','總倉'),
  ('◎四角薯餅','總倉'),
  ('◎冷凍水滴薯球','總倉'),
  ('◎奶青醬','總倉'),
  ('◎粉紅香頌麵包','總倉'),
  ('◎冷凍可口芋簽糕','總倉'),
  ('◎起司豬排','總倉'),
  ('◎培根白醬','總倉'),
  ('◎黃金蝦仁','總倉'),
  ('◎好事堡(新)','總倉'),
  ('◎原味船型薯條','總倉'),
  ('◎舒肥香草雞胸肉','總倉'),
  ('◎切塊紅皮熟栗地瓜','總倉'),
  ('◎魷魚花枝排','總倉'),
  ('◎巧達玉米濃湯','總倉'),
  ('●奶精','總倉'),
  ('●千島醬','總倉'),
  ('●紐約客燒醬','總倉'),
  ('◎龍蝦沙拉(凍)','總倉'),
  ('●韓式泡菜(3KG)','總倉'),
  ('●韓式泡菜(600g)','總倉'),
  ('特選芝麻肉鬆','總倉'),
  ('特選紅茶24入','總倉'),
  ('檸檬紅茶','總倉'),
  ('水蜜桃可爾必思','總倉'),
  ('鮮肉柳丁汁','總倉'),
  ('焦糖糖漿','總倉'),
  ('●墨西哥醬','總倉'),
  ('※芒果沙拉','總倉'),
  ('※芥末醬','總倉'),
  ('※特選田園沙拉','總倉'),
  ('蒜味醬油','總倉'),
  ('花生醬','總倉'),
  ('草莓醬','總倉'),
  ('奶酥醬','總倉'),
  ('紅茶DJ-(蕃)','總倉'),
  ('全脂牛奶(箱)','總倉'),
  ('梅醬','總倉'),
  ('櫻島家-巧克力保久乳','總倉'),
  ('櫻島家-蘋果保久乳','總倉'),
  ('櫻島家-麥芽保久乳','總倉'),
  ('櫻島家-草莓保久乳','總倉'),
  ('櫻島家-原味保久乳','總倉'),
  ('椒麻醬','總倉'),
  ('瓜地馬拉咖啡豆','總倉'),
  ('榛果果露','總倉'),
  ('大海鮪魚','總倉'),
  ('阿華田1KG','總倉'),
  ('醬油膏10g(袋)','總倉'),
  ('丼飯醬','總倉'),
  ('韓國辣味粉','總倉'),
  ('蕃茄村村拌麵','總倉'),
  ('Q彈鍋燒意麵','總倉'),
  ('醬香風味醬','總倉'),
  ('酸黃瓜','總倉'),
  ('韓國柚子醬','總倉'),
  ('湯匙','總倉'),
  ('面紙','總倉'),
  ('橡皮筋','總倉'),
  ('50斤大垃圾袋','總倉'),
  ('生菜沙拉盒蓋','總倉'),
  ('大茶匙','總倉'),
  ('午餐外帶盒','總倉'),
  ('潛艇外帶盒(55個)','總倉'),
  ('長方鋁盒蓋','總倉'),
  ('1000C.C湯杯','總倉'),
  ('1000C.C杯蓋','總倉'),
  ('玉米湯杯蓋','總倉'),
  ('902凸蓋','總倉'),
  ('902扁碗','總倉'),
  ('450C.C.紙湯杯','總倉'),
  ('450C.C.湯杯蓋','總倉'),
  ('漢堡盒蓋','總倉'),
  ('漢堡盒','總倉'),
  ('S號吐司盒','總倉'),
  ('山形吐司塑膠膜','總倉'),
  ('90杯蓋(U型孔)','總倉'),
  ('90冷飲蓋','總倉'),
  ('22公分粗吸管','總倉'),
  ('4杯袋(透明)','總倉'),
  ('六兩防油紙袋(空白)','總倉'),
  ('90四杯架','總倉'),
  ('四杯架(透明)','總倉'),
  ('免洗筷(空白版)','總倉'),
  ('立頓隨身瓶','總倉'),
  ('750ML黑色通用盒','總倉'),
  ('750ML透明通用盒蓋','總倉'),
  ('8吋三格餐盒','總倉'),
  ('8吋三格餐盒蓋','總倉'),
  ('2oz醬料杯蓋','總倉'),
  ('湯碗蓋','總倉'),
  ('玉米湯杯(蕃)','總倉'),
  ('大冰杯(蕃)','總倉'),
  ('冰淇淋杯(50個)(蕃)','總倉'),
  ('點心盒(蕃)','總倉'),
  ('三明治袋(蕃)','總倉'),
  ('五號包裝袋(蕃)','總倉'),
  ('卡啦燻雞雞塊共用包袋(蕃)','總倉'),
  ('熱狗袋(蕃)','總倉'),
  ('玉米湯杯(公)','總倉'),
  ('咖啡豆鋁箔袋','總倉'),
  ('三號包裝袋(袋)','總倉'),
  ('四號包裝袋(袋)','總倉'),
  ('牛皮抱袋','總倉'),
  ('熱狗包裝袋(蕃)','總倉'),
  ('12oz(牛皮)咖啡杯','總倉'),
  ('C90H透明咖啡杯蓋','總倉'),
  ('700cc杯(蕃)','總倉'),
  ('蕃茄村牛仔制服-M','總倉'),
  ('蕃茄村牛仔制服-XL','總倉'),
  ('蕃茄村2018手提環保袋','總倉'),
  ('5入咖啡盒','總倉'),
  ('咖啡禮盒紙袋','總倉'),
  ('北北卡藝妓五盒組','總倉'),
  ('360冷熱杯','總倉'),
  ('◎優質脆薯','總倉'),
  ('◎巧達玉米濃湯(7包送1包)','總倉'),
  ('500冷熱杯','總倉'),
  ('700冷熱杯','總倉'),
  ('L型漢堡袋(蕃)-190','總倉'),
  ('蕃茄村牛仔制服-S','總倉'),
  ('蕃茄村牛仔制服-L','總倉')
),
resolved AS (
  SELECT
    ei.id AS erp_inventory_id,
    s.id  AS supplier_id,
    src.supplier_product_name
  FROM src
  JOIN tb_mgmt.erp_inventory ei
    ON ei.erp_inventory_name = src.supplier_product_name
  JOIN tb_mgmt.suppliers s
    ON s.supplier_name = src.supplier_name
)
INSERT INTO tb_mgmt.erp_inventory_suppliers (
  erp_inventory_id,
  supplier_id,
  supplier_product_name
)
SELECT
  erp_inventory_id,
  supplier_id,
  supplier_product_name
FROM resolved
ON CONFLICT (erp_inventory_id) DO UPDATE
SET
  supplier_id = EXCLUDED.supplier_id,
  supplier_product_name = EXCLUDED.supplier_product_name,
  updated_at = NOW();